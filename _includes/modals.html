<!-- Portfolio Modals -->
{% for post in site.posts %}
   <div class="portfolio-modal modal fade" id="portfolioModal{{ post.modal-id }}" tabindex="-1" role="dialog" aria-hidden="true">
       <div class="modal-content">
           <div class="close-modal" data-dismiss="modal" data-target="#portfolioModal{{ post.modal-id }}">
               <div class="lr">
                   <div class="rl"></div>
               </div>
           </div>
           <div class="container">
               <div class="row">
                   <div class="col-lg-8 col-lg-offset-2">
                       <div class="modal-body">
                           <h2>{{ post.title }}</h2>
                           <hr class="star-primary">
                           {% if post.video %}
                               <div class="embed-responsive embed-responsive-16by9">
                                   <iframe id="video-{{ post.modal-id }}" class="embed-responsive-item" data-src="{{ post.video }}?autoplay=1&loop=1&playlist={{ post.video_id }}&mute=1" src="{{ post.video }}?autoplay=1&loop=1&playlist={{ post.video_id }}&mute=1" allowfullscreen></iframe>
                               </div>
                           {% else %}
                               <img src="img/mockup/{{ post.img }}" class="img-responsive img-centered" alt="{{ post.alt }}">
                           {% endif %}
                           <p>{{ post.description }}</p>
                           <button type="button" class="btn btn-default close-btn" data-dismiss="modal" data-target="#portfolioModal{{ post.modal-id }}"><i class="fa fa-times"></i> Close</button>
                       </div>
                   </div>
               </div>
           </div>
       </div>
   </div>
{% endfor %}

<!-- JavaScript to stop video on button click -->
<script>
var stopVideos = function (modalId) {
    print("coucou2");
    var video = document.querySelector(modalId + ' iframe, ' + modalId + ' video');
    if (video) {
        print("coucou3");
        if (video.tagName.toLowerCase() === 'video') {
            print("coucou4");
            video.pause();
        } else {
            print("coucou5");
            var src = video.src;
            video.src = src; // Reset the iframe source to stop the video
        }
    }
};

// Detect clicks on close buttons and stop video
$(document).on('click', '.close-modal, .close-btn', function () {
    print("coucou1");
    var modalId = $(this).data('target');
    stopVideos(modalId);
});
</script>
